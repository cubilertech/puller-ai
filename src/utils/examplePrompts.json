{
  "canigetalistofuserswho'vepurchasedaticketandareeligibleforentryintotheeventbuthavenotopenedanemailfrom%brand%inthelast3days?": {
    "message": "Can I get a list of users who've purchased a ticket and are eligible for entry into the event but have not opened an email from %Brand% in the last 3 days?",
    "description": "This query finds all [user_hover] who have bought a ticket to an active event, but haven't opened an email from %Brand% [last_3_days] . It does this by combining data from the users, tickets, and events tables to identify users who have purchased a ticket and are [eligible_hover] to attend an event. Then, it checks if these users have opened an email from %Brand% in the last [num_last_days] days. If they haven't, they are included in the result list.",
    "id": "query#1234567896",
    "sql": "SELECT u.* FROM users u JOIN tickets t ON u.id = t.user_id JOIN events e ON t.event_id = e.id LEFT JOIN email_openings eo ON u.id = eo.user_id AND eo.email_subject = '%Brand%' AND eo.opened_at > DATE_SUB(CURRENT_DATE, INTERVAL 3 DAY) WHERE eo.user_id IS NULL AND t.status = 'purchased' AND e.status = 'active';",
    "target": "",
    "variables": [
        {
          "id": "user_hover",
          "model": "",
          "name": "User_Hover",
          "type": "String_hover",
          "value": "users",
          "txt": "users",
          "detail": "Users here are globally purchasers, email recipients, and event attendees."
        },
        {
          "id": "last_3_days",
          "model": "",
          "name": "Last_3_Days",
          "type": "String_hover",
          "value": "in the last 3 days",
          "txt": "in the last 3 days",
          "detail": "Users must have opened an email, but not in the most recent three days starting September 9th 2024 inclusive."
        },
        {
          "id": "eligible_hover",
          "model": "",
          "name": "Eligible_Hover",
          "type": "String_hover",
          "value": "eligible",
          "txt": "eligible",
          "detail": "Eligibility is determined by whether ticket purchased has access for the current date of request."
        },
       
          {
            "id": "num_last_days",
            "model": "",
            "name": "num_last_days",
            "type": "numeric",
            "value": 3,
            "txt": 3,
            "description": "Chose Number of last days."
          } 
      
    ],
    "graph": [],
    "observations":"Roughly 85% of email recipients who also had access eligibility to the event, have opened an email in the last three days. This leaves around 8,500 users who have yet to open the app.",
    "notes": [
      "Check back frequently: This data set updates in near real time, consider checking this query again to see if the user set has changed as time goes by.",
      "Snowflake table note: The query pulls from a table that is known to have null values which means “0”, according to your colleagues.",
      "Similar request: Your request is similar to several other queries in your network, check them out now.",
      "Automate your workflow: Are you building a list for an email campaign? Connect your campaign tool to automate this process for the future.",
      "Personalization: Consider using cluster analysis to use AI to include more relevant attributes like in-event behavior, retail purchases, and ticket scans at entry."
    ],
    "columns": [
      "UID",
      "Email Address",
      "Eligible (Y/N)",
      "Last opened email date"
    ],
    "rows": [
    {
      "UID": 21,
      "Email Address": "ahmad@gmail.com",
      "Eligible (Y/N)": "Y",
      "Last opened email date": "2024-09-01"
    },
    {
      "UID": 22,
      "Email Address": "bilal@gmail.com",
      "Eligible (Y/N)": "Y",
      "Last opened email date": "2024-08-20"
    },
    {
      "UID": 23,
      "Email Address": "mirza@gmail.com",
      "Eligible (Y/N)": "Y",
      "Last opened email date": "2024-08-06"
    },
    {
      "UID": 24,
      "Email Address": "jhon@gmail",
      "Eligible (Y/N)": "Y",
      "Last opened email date": "2024-08-02"
    },
    {
      "UID": 25,
      "Email Address": "devin@gmail.com",
      "Eligible (Y/N)": "Y",
      "Last opened email date": "2024-08-01"
    }
  ],
    "status": "complete",
    "results": [
      {
        "bytes": 2.6,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 44,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example5.csv"
      }
    ]
  },
  "couldyougetthetop10performingskusbyregionforthelastquarter?": {
    "message": "Could you get the top 10 performing SKUs by region for the last quarter?",
    "description":"This query looks at the Sales by Region for %Brand% and filters for sales in the [quarter_last] and groups by region and SKU. It then calculates the [revenue_txt] for each SKU within each region. Finally it orders the results by total revenue in descending order and returns only the top [top_skus_number] SKUs.",
    "id":"query#1234567890",
    "sql":"SELECT TOP 10 r.region, s.sku, SUM(s.revenue) AS total_revenue, FROM sales s JOIN region r ON s.region_id = r.id WHERE s.sale_date >= DATEADD(quarter, -1, GETDATE()) GROUP BY r.region, s.sku ORDER BY total_revenue DESC;",
    "target":"",
    "graph":[],
    "variables":[
      {
      "id": "quarter_last",
      "model": "",
      "name": "last_quarter",
      "type": "select_single",
      "value": "last quarter",
      "txt": "last quarter",
      "detail": "The last quarter refers to the most recent complete calendar quarter ending Mar 31 2024",
      "description":  "Choose target period end date, inclusive.",
      "selectData": ["First quarter", "Second quarter", "Third quarter","Last Quarter"]
    },
     {
      "id": "revenue_txt",
      "model": "",
      "name": "revenue",
      "type": "select_single",
      "value": "total revenue",
      "txt": "total revenue",
      "description": "Choose how to rank SKUs",
      "selectData": ["Total Revenue", "Total Units Sold", "Avg Profit Margin"]
    },
    {
      "id": "top_skus_number",
      "model": "",
      "name": "top_skus",
      "type": "numeric",
      "value": 10,
      "txt": 10
    }],
    "observations":"In the last quarter, the top 10 SKUs for %Brand% generated a combined total revenue of $2.5 million, with the highest contributions from the North and West regions, accounting for $1.2 million and $900,000 respectively. These SKUs achieved significant sales volumes, with the top SKU selling 15,000 units, and maintained an average profit margin of 25%, suggesting both high demand and profitability.",
    "notes":["Broad Sales Overview: The data covers last quarter sales for all SKUs across multiple regions, providing a broad view of performance. Analyzing monthly sales trends could reveal important seasonal patterns.","Demographic Insights: Investigating customer demographics could help identify key buyer segments and improve targeted marketing. This demographic analysis can be particularly useful for tailoring regional strategies.","Impact of Marketing: Evaluating regional marketing efforts could provide insights into their impact on sales. For example, a 15% sales increase in the West region coincided with a recent ad campaign.","Quarterly Growth Analysis: Comparing current performance with previous quarters can help identify growth trends. Sales grew by 10% compared to the previous quarter, highlighting consistent growth.","Inventory Turnover Insights: Exploring inventory turnover rates alongside sales data can provide a fuller picture of SKU performance. High turnover rates might indicate strong demand and efficient inventory management"],
    "columns": ["Region", "Product", "Revenue", "Units Sold", "Profit Margin"],
    "rows": [
      {"Region": "North", "Product": "Product A", "Revenue": "$62,500", "Units Sold": 550, "Profit Margin": "30%"},
      {"Region": "South", "Product": "Product B", "Revenue": "$45,000", "Units Sold": 400, "Profit Margin": "22%"},
      {"Region": "East", "Product": "Product C", "Revenue": "$70,000", "Units Sold": 650, "Profit Margin": "28%"},
      {"Region": "West", "Product": "Product D", "Revenue": "$80,000", "Units Sold": 700, "Profit Margin": "25%"},
      {"Region": "North", "Product": "Product E", "Revenue": "$55,000", "Units Sold": 450, "Profit Margin": "20%"},
      {"Region": "South", "Product": "Product F", "Revenue": "$42,000", "Units Sold": 350, "Profit Margin": "18%"},
      {"Region": "East", "Product": "Product G", "Revenue": "$65,000", "Units Sold": 600, "Profit Margin": "26%"},
      {"Region": "West", "Product": "Product H", "Revenue": "$75,000", "Units Sold": 550, "Profit Margin": "24%"},
      {"Region": "North", "Product": "Product I", "Revenue": "$57,500", "Units Sold": 500, "Profit Margin": "23%"},
      {"Region": "South", "Product": "Product J", "Revenue": "$40,000", "Units Sold": 300, "Profit Margin": "15%"},
      {"Region": "East", "Product": "Product K", "Revenue": "$75,000", "Units Sold": 650, "Profit Margin": "21%"},
      {"Region": "West", "Product": "Product L", "Revenue": "$85,000", "Units Sold": 750, "Profit Margin": "27%"},
      {"Region": "North", "Product": "Product M", "Revenue": "$60,000", "Units Sold": 550, "Profit Margin": "19%"},
      {"Region": "South", "Product": "Product N", "Revenue": "$50,000", "Units Sold": 400, "Profit Margin": "24%"},
      {"Region": "East", "Product": "Product O", "Revenue": "$80,000", "Units Sold": 700, "Profit Margin": "29%"},
      {"Region": "West", "Product": "Product P", "Revenue": "$90,000", "Units Sold": 800, "Profit Margin": "17%"},
      {"Region": "North", "Product": "Product Q", "Revenue": "$65,000", "Units Sold": 600, "Profit Margin": "28%"},
      {"Region": "South", "Product": "Product R", "Revenue": "$55,000", "Units Sold": 500, "Profit Margin": "16%"},
      {"Region": "East", "Product": "Product S", "Revenue": "$85,000", "Units Sold": 750, "Profit Margin": "25%"},
      {"Region": "West", "Product": "Product T", "Revenue": "$95,000", "Units Sold": 850, "Profit Margin": "22%"},
      {"Region": "North", "Product": "Product U", "Revenue": "$70,000", "Units Sold": 650, "Profit Margin": "20%"},
      {"Region": "South", "Product": "Product V", "Revenue": "$60,000", "Units Sold": 550, "Profit Margin": "26%"},
      {"Region": "East", "Product": "Product W", "Revenue": "$90,000", "Units Sold": 800, "Profit Margin": "17%"},
      {"Region": "West", "Product": "Product X", "Revenue": "$100,000", "Units Sold": 900, "Profit Margin": "30%"},
      {"Region": "North", "Product": "Product Y", "Revenue": "$75,000", "Units Sold": 700, "Profit Margin": "18%"},
      {"Region": "South", "Product": "Product Z", "Revenue": "$65,000", "Units Sold": 600, "Profit Margin": "27%"},
      {"Region": "East", "Product": "Product AA", "Revenue": "$95,000", "Units Sold": 850, "Profit Margin": "23%"},
      {"Region": "West", "Product": "Product BB", "Revenue": "$105,000", "Units Sold": 950, "Profit Margin": "21%"},
      {"Region": "North", "Product": "Product CC", "Revenue": "$80,000", "Units Sold": 750, "Profit Margin": "16%"},
      {"Region": "South", "Product": "Product DD", "Revenue": "$70,000", "Units Sold": 650, "Profit Margin": "29%"},
      {"Region": "East", "Product": "Product EE", "Revenue": "$100,000", "Units Sold": 900, "Profit Margin": "19%"},
      {"Region": "West", "Product": "Product FF", "Revenue": "$110,000", "Units Sold": 1000, "Profit Margin": "24%"},
      {"Region": "North", "Product": "Product GG", "Revenue": "$85,000", "Units Sold": 800, "Profit Margin": "20%"},
      {"Region": "South", "Product": "Product HH", "Revenue": "$75,000", "Units Sold": 700, "Profit Margin": "25%"},
      {"Region": "East", "Product": "Product II", "Revenue": "$105,000", "Units Sold": 950, "Profit Margin": "22%"},
      {"Region": "West", "Product": "Product JJ", "Revenue": "$115,000", "Units Sold": 1050, "Profit Margin": "17%"},
      {"Region": "North", "Product": "Product KK", "Revenue": "$90,000", "Units Sold": 850, "Profit Margin": "26%"},
      {"Region": "South", "Product": "Product LL", "Revenue": "$80,000", "Units Sold": 750, "Profit Margin": "20%"},
      {"Region": "East", "Product": "Product MM", "Revenue": "$110,000", "Units Sold": 1000, "Profit Margin": "18%"},
      {"Region": "West", "Product": "Product NN", "Revenue": "$120,000", "Units Sold": 1100, "Profit Margin": "27%"}
    ],
    "status": "complete",
    "results":[{
        "bytes": 1.4,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 29,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example1.csv"
      }]
  },
  "i’dlikeatablethatshowsmetheaverageordervalueof%brand%productscomparedtotheaverageordervalueoftherestofcategoryeachquarterforthelast4quarters.":{
    "message":"I’d like a table that shows me the average order value of %Brand% products compared to the average order value of the rest of category each quarter for the last 4 quarters.",
    "description":"This query first calculates the total order value and number of orders for each product from the Sales DB and for the category (minus our products) from the Category DB for each quarter, using sales database. It then calculates the [average_value] for our products and the rest of category for each quarter, and returns the results for most recent [four_quarters] quarters.",
    "id":"query#1234567891",
    "sql":"WITH product_sales AS ( SELECT EXTRACT(QUARTER FROM sale_date) AS sale_quarter, EXTRACT(YEAR FROM sale_date) AS sale_year, product_id, SUM(order_value) AS total_order_value, COUNT(DISTINCT order_id) AS num_orders FROM sales_data WHERE product_id IN (SELECT product_id FROM product_db WHERE brand = '%Brand%') GROUP BY EXTRACT(QUARTER FROM sale_date), EXTRACT(YEAR FROM sale_date), product_id ), category_sales AS ( SELECT EXTRACT(QUARTER FROM sale_date) AS sale_quarter, EXTRACT(YEAR FROM sale_date) AS sale_year, category_id, SUM(order_value) AS total_order_value, COUNT(DISTINCT order_id) AS num_orders FROM sales_data WHERE product_id NOT IN (SELECT product_id FROM product_db WHERE brand = '%Brand%') AND category_id IN (SELECT category_id FROM product_db WHERE brand = '%Brand%') GROUP BY EXTRACT(QUARTER FROM sale_date), EXTRACT(YEAR FROM sale_date), category_id ) SELECT p.sale_quarter, p.sale_year, AVG(p.total_order_value / p.num_orders) AS avg_order_value, AVG(c.total_order_value / c.num_orders) AS avg_category_order_value FROM product_sales p JOIN category_sales c ON p.sale_quarter = c.sale_quarter AND p.sale_year = c.sale_year WHERE p.sale_quarter IN ( SELECT EXTRACT(QUARTER FROM sale_date) FROM sales_data WHERE EXTRACT(YEAR FROM sale_date) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY sale_date DESC LIMIT 4 ) GROUP BY p.sale_quarter, p.sale_year ORDER BY p.sale_quarter DESC;",
    "target":"",
    "graph":[
        {
            "depends": [],
            "description": "table of sales data",
            "id": "model.dbt_tutorial.sales",
            "name": "sales"
          },
          {
            "depends": [],
            "description": "table of orders data",
            "id": "model.dbt_tutorial.orders",
            "name": "orders"
          },
          {
            "depends": [
                "model.dbt_tutorial.sales",
                "model.dbt_tutorial.orders"
              ],
            "description":
              "the results for the most recent N quarters",
            "id": "model.dbt_tutorial.quarter",
            "name": "quarter"
          },
          {
            "depends": ["model.dbt_tutorial.quarter"],
            "description": "table of products data",
            "id": "model.dbt_tutorial.products",
            "name": "products"
          }
    ],
    "variables":[
      {
        "id": "average_value",
        "model": "model.dbt_tutorial.average_value",
        "name": "Average_Value",
        "type": "String_hover",
        "value": "average order value",
        "txt": "average order value",
        "detail": "Average order value calculated by dividing Total Order Value by Number of Orders."
      },
      {
        "id": "most_recent",
        "model": "model.dbt_tutorial.most_recent",
        "name": "Most_Recent",
        "type": "String_hover",
        "value": "the most recent",
        "txt": "the most recent",
        "detail": "The most recent four quarters refers whole calendar quarters, ending March 31, 2024."
      },
      {
        "id": "four_quarters",
        "model": "model.dbt_tutorial.quarter",
        "name": "Average_Value",
        "type": "numeric",
        "value": 4,
        "txt": 4,
        "description": "Choose the most recent N quarters"
      }
    ],
    "observations":"In the most recent four quarters, our products generated a total revenue of $10 million across all regions, with an average order value of $300. Comparatively, the rest of the category contributed $20 million in revenue with an average order value of $200.",
    "notes":["Quarterly Revenue Trends: Analyzing quarterly revenue trends can help identify seasonal patterns or fluctuations in consumer demand.","Profit Margin Analysis: Calculate the average profit margin for our products and compare it with the category average to assess profitability.","Geographical Performance: Assess sales performance by region, calculating the percentage increase in revenue by region compared to the previous quarter. We’re seeing up to 20% increases in certain regions which is greater than what we’d expect this year.","Promotional Impact: Evaluate the ROI for recent promotional activities by calculating the percentage increase in revenue attributed to promotions. The average promotional lift for this time period is 15%, which is 1.5% less than previous year.","Customer Segmentation: Segment customers based on purchasing behavior to target marketing efforts effectively using Puller AI’s advanced analytics module."],
    "columns": [
      "Quarter",
      "Total Order Value (Sales DB)",
      "Number of Orders (Sales DB)",
      "Average Order Value (Sales DB)",
      "Category Total Order Value (Category DB)",
      "Category Number of Orders (Category DB)",
      "Category Average Order Value (Category DB)"
    ],
    "rows": 
    [
      {
          "Quarter": 4,
          "Total Order Value (Sales DB)": 150.00,
          "Number of Orders (Sales DB)": 1,
          "Average Order Value (Sales DB)": 150.00,
          "Category Total Order Value (Category DB)": 250.00,
          "Category Number of Orders (Category DB)": 1,
          "Category Average Order Value (Category DB)": 250.00
      },
      {
          "Quarter": 4,
          "Total Order Value (Sales DB)": 200.00,
          "Number of Orders (Sales DB)": 1,
          "Average Order Value (Sales DB)": 200.00,
          "Category Total Order Value (Category DB)": 350.00,
          "Category Number of Orders (Category DB)": 1,
          "Category Average Order Value (Category DB)": 350.00
      },
      {
          "Quarter": 4,
          "Total Order Value (Sales DB)": 250.00,
          "Number of Orders (Sales DB)": 1,
          "Average Order Value (Sales DB)": 250.00,
          "Category Total Order Value (Category DB)": 400.00,
          "Category Number of Orders (Category DB)": 1,
          "Category Average Order Value (Category DB)": 400.00
      },
      {
          "Quarter": 4,
          "Total Order Value (Sales DB)": 300.00,
          "Number of Orders (Sales DB)": 1,
          "Average Order Value (Sales DB)": 300.00,
          "Category Total Order Value (Category DB)": 450.00,
          "Category Number of Orders (Category DB)": 1,
          "Category Average Order Value (Category DB)": 450.00
      },
      {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1050.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1050.00,
        "Category Total Order Value (Category DB)": 1200.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1200.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1100.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1100.00,
        "Category Total Order Value (Category DB)": 1250.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1250.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1150.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1150.00,
        "Category Total Order Value (Category DB)": 1300.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1300.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1200.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1200.00,
        "Category Total Order Value (Category DB)": 1350.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1350.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1250.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1250.00,
        "Category Total Order Value (Category DB)": 1400.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1400.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1300.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1300.00,
        "Category Total Order Value (Category DB)": 1450.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1450.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1350.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1350.00,
        "Category Total Order Value (Category DB)": 1500.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1500.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1400.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1400.00,
        "Category Total Order Value (Category DB)": 1550.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1550.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1450.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1450.00,
        "Category Total Order Value (Category DB)": 1600.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1600.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1500.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1500.00,
        "Category Total Order Value (Category DB)": 1650.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1650.00
    },
    {
        "Quarter": 4,
        "Total Order Value (Sales DB)": 1550.00,
        "Number of Orders (Sales DB)": 1,
        "Average Order Value (Sales DB)": 1550.00,
        "Category Total Order Value (Category DB)": 1700.00,
        "Category Number of Orders (Category DB)": 1,
        "Category Average Order Value (Category DB)": 1700.00
    }
    ]
  , 
    "status": "complete",
    "results":[{
        "bytes": 2.1,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 29,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example4.csv"
      }]
  },
  "canyouretrievealistofproductswithcurrentinventorylevelsbelow%brand%thresholdforreorder,aswellasthelastdateinventorylevelswereatorabovethreshold.includethereorderquantityaswell.": {
    "message": "Can you retrieve a list of products with current inventory levels below %Brand% threshold for reorder, as well as the last date inventory levels were at or above threshold. Include the reorder quantity as well.",
    "description":"This query joins the Products table with [goods_table_field] on the [prodID_field] field, and filters for products where the current stock level is below the reorder level. [inventory_levels_threshold] Finally, it includes the reorder level and the current stock level in the result set. \nNote that the Goods table is a table that stores the stock in and out for each product, with separate fields for the quantity and the date. The Stock field is calculated as the difference between the In and Out fields, and the ReorderLevel field is a threshold value that triggers a reorder when the stock level falls below it.",
    "id":"query#1234567892",
    "sql":"SELECT Products.ID, Products.Product, Products.Description, Products.Price, Products.Category, Products.Supplier, Goods.Stock, Goods.ReorderLevel, MAX(CASE WHEN Goods.Stock >= Products.ReorderLevel THEN Goods.Date END) AS LastDateAboveThreshold FROM Products INNER JOIN Goods ON Products.ID = Goods.Product ID WHERE Goods.Stock < Products.ReorderLevel GROUP BY Products.ID, Products.Product, Products.Description, Products.Price, Products.Category, Products.Supplier, Goods.Stock, Goods.ReorderLevel;",
    "target":"",
    "graph":[],
    "variables":[
      {
        "id": "goods_table_field",
        "model": "",
        "name": "Goods_table",
        "type": "String_hover",
        "value": "the Goods table ",
        "txt": "the Goods table ",
        "detail": "Note that the Goods table is a table that stores the stock in and out for each product, with separate fields for the quantity and the date. The Stock field is calculated as the difference between the In and Out fields, and the ReorderLevel field is a threshold value that triggers a reorder when the stock level falls below it."
      },  
      {
        "id": "prodID_field",
        "model": "",
        "name": "ProdID_field",
        "type": "select_single",
        "value": "Product ID",
        "txt": "Product ID",
        "detail": "Product ID refers to the 'Product ID' field",
        "description": "Choose Your Product",
        "selectData": ["Product ID", "Product_ID_OLD", "ProductALTNUM"]
      },
      {
        "id": "inventory_levels_threshold",
        "model": "",
        "name": "Inventory_Levels_Threshold",
        "type": "String_hover",
        "value": "It then calculates the last date the inventory levels were at or above the threshold.",
        "txt": "It then calculates the last date the inventory levels were at or above the threshold.",
        "detail": "This calculation uses a conditional aggregate function"
      }
    ],
    "observations":"This query identifies 50 products with current stock levels below the reorder threshold. The last date inventory levels were at or above the threshold was two weeks ago on average. Reorder levels range from 100 to 500 units, while current stock levels range from 20 to 450 units.",
    "notes":["Data Context: The Goods table facilitates accurate inventory management by tracking stock in and out for each product.","Replenishment Efficiency: Average time taken to replenish stock levels after reaching the threshold provides insights into inventory management efficiency (averaging 14 days).","Inventory Variation: Notable differences exist in reorder and current stock levels among products, with reorder levels ranging from 100 to 500 units and current stock levels ranging from 20 to 450 units.","Irregular Replenishments: Some products may experience sporadic or irregular stock replenishments, possibly due to supplier constraints or seasonal demand fluctuations.","Optimization Opportunities: With an average of 50 products requiring reordering each week, it's evident that inventory management strategies need refinement to minimize stockouts and ensure optimal inventory levels."],
    "columns": [
      "ID",
      "Product",
      "Description",
      "Price",
      "Category",
      "Supplier",
      "Stock",
      "ReorderLevel",
      "LastDateAboveThreshold"
  ],
  "rows": 
  [
    {
        "ID": 1,
        "Product": "Product A",
        "Description": "High-quality smartphone with advanced features",
        "Price": 12.76,
        "Category": "Electronics",
        "Supplier": "Trailblazers",
        "Stock": 4,
        "ReorderLevel": 11,
        "LastDateAboveThreshold": "2024-05-16"
    },
    {
        "ID": 2,
        "Product": "Product B",
        "Description": "Durable basketball for outdoor play",
        "Price": 67.29,
        "Category": "Sports",
        "Supplier": "Fashion Fair",
        "Stock": 4,
        "ReorderLevel": 6,
        "LastDateAboveThreshold": "2024-05-25"
    },
    {
        "ID": 3,
        "Product": "Product C",
        "Description": "Stylish and comfortable home sofa",
        "Price": 25.17,
        "Category": "Homeware",
        "Supplier": "Acme Inc.",
        "Stock": 4,
        "ReorderLevel": 17,
        "LastDateAboveThreshold": "2024-05-03"
    },
    {
        "ID": 4,
        "Product": "Product D",
        "Description": "Trendy summer dress",
        "Price": 88.13,
        "Category": "Clothing",
        "Supplier": "Cozy Home",
        "Stock": 6,
        "ReorderLevel": 13,
        "LastDateAboveThreshold": "2024-05-13"
    },
    {
        "ID": 5,
        "Product": "Product E",
        "Description": "Modern and sleek kitchen toaster",
        "Price": 38.38,
        "Category": "Homeware",
        "Supplier": "Tech Labs",
        "Stock": 3,
        "ReorderLevel": 16,
        "LastDateAboveThreshold": "2024-05-26"
    },
    {
        "ID": 6,
        "Product": "Product F",
        "Description": "Noise-canceling wireless headphones",
        "Price": 24.53,
        "Category": "Electronics",
        "Supplier": "Fashion Fair",
        "Stock": 5,
        "ReorderLevel": 10,
        "LastDateAboveThreshold": "2024-05-24"
    },
    {
        "ID": 7,
        "Product": "Product G",
        "Description": "Professional quality tennis racket",
        "Price": 57.49,
        "Category": "Sports",
        "Supplier": "Tech Labs",
        "Stock": 5,
        "ReorderLevel": 14,
        "LastDateAboveThreshold": "2024-05-04"
    },
    {
        "ID": 8,
        "Product": "Product H",
        "Description": "Inspirational self-help book",
        "Price": 42.59,
        "Category": "Books",
        "Supplier": "Trailblazers",
        "Stock": 2,
        "ReorderLevel": 8,
        "LastDateAboveThreshold": "2024-05-15"
    },
    {
        "ID": 9,
        "Product": "Product I",
        "Description": "Interactive and educational toy for kids",
        "Price": 11.89,
        "Category": "Toys",
        "Supplier": "Fashion Fair",
        "Stock": 8,
        "ReorderLevel": 12,
        "LastDateAboveThreshold": "2024-05-10"
    },
    {
        "ID": 10,
        "Product": "Product J",
        "Description": "4K Ultra HD Smart TV",
        "Price": 34.99,
        "Category": "Electronics",
        "Supplier": "Tech Labs",
        "Stock": 6,
        "ReorderLevel": 15,
        "LastDateAboveThreshold": "2024-05-20"
    },
    {
        "ID": 11,
        "Product": "Product K",
        "Description": "Comfortable and stylish men’s jacket",
        "Price": 23.77,
        "Category": "Clothing",
        "Supplier": "Cozy Home",
        "Stock": 7,
        "ReorderLevel": 9,
        "LastDateAboveThreshold": "2024-05-14"
    },
    {
        "ID": 12,
        "Product": "Product L",
        "Description": "Bestselling mystery novel",
        "Price": 59.99,
        "Category": "Books",
        "Supplier": "Acme Inc.",
        "Stock": 3,
        "ReorderLevel": 7,
        "LastDateAboveThreshold": "2024-05-07"
    },
    {
        "ID": 13,
        "Product": "Product M",
        "Description": "Decorative ceramic vase",
        "Price": 18.75,
        "Category": "Homeware",
        "Supplier": "Trailblazers",
        "Stock": 9,
        "ReorderLevel": 11,
        "LastDateAboveThreshold": "2024-05-30"
    },
    {
        "ID": 14,
        "Product": "Product N",
        "Description": "High-performance laptop",
        "Price": 72.15,
        "Category": "Electronics",
        "Supplier": "Fashion Fair",
        "Stock": 4,
        "ReorderLevel": 12,
        "LastDateAboveThreshold": "2024-05-11"
    },
    {
        "ID": 15,
        "Product": "Product O",
        "Description": "Water-resistant sports watch",
        "Price": 15.29,
        "Category": "Sports",
        "Supplier": "Tech Labs",
        "Stock": 5,
        "ReorderLevel": 10,
        "LastDateAboveThreshold": "2024-05-29"
    },
    {
        "ID": 16,
        "Product": "Product P",
        "Description": "Colorful building blocks for toddlers",
        "Price": 27.49,
        "Category": "Toys",
        "Supplier": "Cozy Home",
        "Stock": 6,
        "ReorderLevel": 14,
        "LastDateAboveThreshold": "2024-05-08"
    },
    {
        "ID": 17,
        "Product": "Product Q",
        "Description": "Comprehensive world atlas",
        "Price": 37.89,
        "Category": "Books",
        "Supplier": "Acme Inc.",
        "Stock": 7,
        "ReorderLevel": 9,
        "LastDateAboveThreshold": "2024-05-22"
    },
    {
        "ID": 18,
        "Product": "Product R",
        "Description": "Soft and absorbent bath towels",
        "Price": 20.99,
        "Category": "Homeware",
        "Supplier": "Trailblazers",
        "Stock": 3,
        "ReorderLevel": 8,
        "LastDateAboveThreshold": "2024-05-12"
    },
    {
        "ID": 19,
        "Product": "Product S",
        "Description": "Stylish and comfortable women's sweater",
        "Price": 65.75,
        "Category": "Clothing",
        "Supplier": "Fashion Fair",
        "Stock": 5,
        "ReorderLevel": 13,
        "LastDateAboveThreshold": "2024-05-18"
    },
    {
        "ID": 20,
        "Product": "Product T",
        "Description": "Ergonomic office chair",
        "Price": 48.15,
        "Category": "Sports",
        "Supplier": "Tech Labs",
        "Stock": 4,
        "ReorderLevel": 11,
        "LastDateAboveThreshold": "2024-05-21"
    },
    {
        "ID": 21,
        "Product": "Product U",
        "Description": "Popular science fiction novel",
        "Price": 29.99,
        "Category": "Books",
        "Supplier": "Acme Inc.",
        "Stock": 2,
        "ReorderLevel": 10,
        "LastDateAboveThreshold": "2024-05-23"
    },
    {
        "ID": 22,
        "Product": "Product V",
        "Description": "Remote-controlled toy car",
        "Price": 22.79,
        "Category": "Toys",
        "Supplier": "Trailblazers",
        "Stock": 5,
        "ReorderLevel": 12,
        "LastDateAboveThreshold": "2024-05-19"
    },
    {
        "ID": 23,
        "Product": "Product W",
        "Description": "Wireless gaming mouse",
        "Price": 16.45,
        "Category": "Electronics",
        "Supplier": "Tech Labs",
        "Stock": 7,
        "ReorderLevel": 11,
        "LastDateAboveThreshold": "2024-05-05"
    }]

 ,
    "status": "complete",
    "results":[{
        "bytes": 1,
        "database": "Prototype",
        "duration": 3.0252435207366943, 
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 29,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example3.csv"
      }]
  },
  "showmethedailyunitanddollarsalesvolumeinallstoresinregionxforanyproductthathas%brand%technologyforthelastweek.comparethatthedailyunitanddollarsalesvolumeofallotherproductsinregionxoverthesametimeperiod.": {
    "message": "Show me the daily unit and dollar sales volume in all stores in region X for any product that has %Brand% Technology for the last week. Compare that the daily unit and dollar sales volume of all other products in region X over the same time period.",
    "description":" The query calculates and compares daily unit and dollar sales volumes for '[star_technology]' products and other products in [region_x] over the [last_week]. First, it filters sales_data for '[star_technology]' products in [region_x] from the last week, grouping by date to calculate total order value and units sold. Then, it Filters sales_data for all other products in [region_x] from the last week, grouping by date to calculate total order value and units sold. Finally, it Joins star_sales and other_sales on sale date, and calculates total and [percentage_volumes] for both categories. The result is a table showing daily sales volumes for '[star_technology]' products versus “all other” products in [region_x], allowing for performance comparison over the past week.",
    "id":"query#1234567893",
    "sql": "WITH star_sales AS (SELECT EXTRACT(DAY FROM sale_date) AS sale_day, EXTRACT(MONTH FROM sale_date) AS sale_month, EXTRACT(YEAR FROM sale_date) AS sale_year, product_id, SUM(order_value) AS daily_order_value, SUM(units_sold) AS daily_units_sold FROM sales_data WHERE product_category LIKE '%Star Technology%' AND region = 'X' AND sale_date >= CURRENT_DATE - INTERVAL 'First week' GROUP BY EXTRACT(DAY FROM sale_date), EXTRACT(MONTH FROM sale_date), EXTRACT(YEAR FROM sale_date), product_id), other_sales AS (SELECT EXTRACT(DAY FROM sale_date) AS sale_day, EXTRACT(MONTH FROM sale_date) AS sale_month, EXTRACT(YEAR FROM sale_date) AS sale_year, product_id, SUM(order_value) AS daily_order_value, SUM(units_sold) AS daily_units_sold FROM sales_data WHERE product_category NOT LIKE '%Star Technology%' AND region = 'X' AND sale_date >= CURRENT_DATE - INTERVAL 'First week' GROUP BY EXTRACT(DAY FROM sale_date), EXTRACT(MONTH FROM sale_date), EXTRACT(YEAR FROM sale_date), product_id) SELECT s.sale_day, s.sale_month    ",
    "target":"",
    "graph":[],
    "variables":[
    {
      "id": "star_technology",
      "model": "",
      "name": "Star_Technology",
      "type": "select_multi",
      "value": "Star Technology",
      "txt": "Star Technology",
      "detail": "Includes any SKU that with product with attributes 'STAR_int' 'Star group' or 'New_Star_SKU'.",
      "selectData": ["STAR_int", "Star_group", "New_Star_SKU"]
    },
  {
    "id": "region_x",
    "model": "",
    "name": "Region_X",
    "type": "select_single",
    "value": "Region X",
    "txt": "Region X",
    "selectData": ["Region N", "Region O", "Region P", "Region Q", "Region R", "Region S", "Region T", "Region U", "Region V", "Region W", "Region X", "Region Y", "Region Z"]
  },
  {
    "id": "last_week",
    "model": "",
    "name": "last_week",
    "type": "select_single",
    "value": "last week",
    "txt": "last week",
    "detail": "The last week means the most recent complete week ending May 31 2024",
    "selectData": ["First Week", "Last Week"]
  },
  {
    "id": "percentage_volumes",
    "model": "",
    "name": "Percentage_Volumes",
    "type": "String_hover",
    "value": "percentage sales volumes",
    "txt": "percentage sales volumes",
    "detail": "This calculation will show Star Technology product sales as a percentage of all other sales."
  }
],
    "observations":"Over the past week in Region X, 'Star Technology' products generated a total revenue of $50,000 and sold 500 units, while 'all other' products achieved $70,000 in revenue with 700 units sold. The top-selling day was Thursday, with 'Star Technology' products accounting for 40% of total sales volume.",
    "notes":["Daily Sales Trends: To evaluate comparative sales on a day over day basis. Calculate the average daily revenue and units sold for each product category. For example, the average daily revenue in the last day for 'Star Technology' products was $7,143, and for 'all other' products was $10,000.","Product Performance Comparison: We recommend comparing the average daily revenue and units sold between 'Star Technology' products and 'all other' products to assess performance, but excluding products that were new during the evaluation period. For instance, 'all other' products may have a higher average daily revenue per unit sold compared to 'Star Technology' products due to new product volume, so the comparison could mislead.","Seasonal Variations: Calculate the percentage change in sales volume from the previous week to identify any significant seasonal variations. For example, sales volume increased by 20% compared to the previous week, and we see similar lifts year on year, this potentially indicates a seasonal spike in demand.","Promotional Analysis: Determine the impact of promotions by calculating the percentage increase in sales volume or revenue during the promotional period. For instance, sales volume increased by 30% during the latest promotion, which suggests a successful campaign.","Customer Preferences: A ratio analysis between all other products and Star Technology products could help uncover customer Preferences. It may be worth reviewing consumer insights trends from the CI_2023 retriever for additional context."],
    "columns": ["Date", "Star Tech Units Sold", "Star Tech Dollar Sales", "Other Units Sold", "Other Dollar Sales", "Total Units Sold", "Total Dollar Sales", "Star Tech Units %", "Star Tech Dollar %"],
    "rows": [
      {"Date": "2023-05-15", "Star Tech Units Sold": "120", "Star Tech Dollar Sales": "$24,000", "Other Units Sold": "450", "Other Dollar Sales": "$90,000", "Total Units Sold": "570", "Total Dollar Sales": "$114,000", "Star Tech Units %": "21.05%", "Star Tech Dollar %": "21.05%"},
      {"Date": "2023-05-16", "Star Tech Units Sold": "110", "Star Tech Dollar Sales": "$22,000", "Other Units Sold": "480", "Other Dollar Sales": "$96,000", "Total Units Sold": "590", "Total Dollar Sales": "$118,000", "Star Tech Units %": "18.64%", "Star Tech Dollar %": "18.64%"},
      {"Date": "2023-05-17", "Star Tech Units Sold": "130", "Star Tech Dollar Sales": "$26,000", "Other Units Sold": "500", "Other Dollar Sales": "$100,000", "Total Units Sold": "630", "Total Dollar Sales": "$126,000", "Star Tech Units %": "20.63%", "Star Tech Dollar %": "20.63%"},
      {"Date": "2023-05-18", "Star Tech Units Sold": "115", "Star Tech Dollar Sales": "$23,000", "Other Units Sold": "460", "Other Dollar Sales": "$92,000", "Total Units Sold": "575", "Total Dollar Sales": "$115,000", "Star Tech Units %": "20.00%", "Star Tech Dollar %": "20.00%"},
      {"Date": "2023-05-19", "Star Tech Units Sold": "140", "Star Tech Dollar Sales": "$28,000", "Other Units Sold": "520", "Other Dollar Sales": "$104,000", "Total Units Sold": "660", "Total Dollar Sales": "$132,000", "Star Tech Units %": "21.21%", "Star Tech Dollar %": "21.21%"},
      {"Date": "2023-05-20", "Star Tech Units Sold": "125", "Star Tech Dollar Sales": "$25,000", "Other Units Sold": "490", "Other Dollar Sales": "$98,000", "Total Units Sold": "615", "Total Dollar Sales": "$123,000", "Star Tech Units %": "20.33%", "Star Tech Dollar %": "20.33%"},
      {"Date": "2023-05-21", "Star Tech Units Sold": "135", "Star Tech Dollar Sales": "$27,000", "Other Units Sold": "510", "Other Dollar Sales": "$102,000", "Total Units Sold": "645", "Total Dollar Sales": "$129,000", "Star Tech Units %": "20.93%", "Star Tech Dollar %": "20.93%"},
      {"Date": "2023-05-22", "Star Tech Units Sold": "105", "Star Tech Dollar Sales": "$21,000", "Other Units Sold": "470", "Other Dollar Sales": "$94,000", "Total Units Sold": "575", "Total Dollar Sales": "$115,000", "Star Tech Units %": "18.26%", "Star Tech Dollar %": "18.26%"},
      {"Date": "2023-05-23", "Star Tech Units Sold": "150", "Star Tech Dollar Sales": "$30,000", "Other Units Sold": "540", "Other Dollar Sales": "$108,000", "Total Units Sold": "690", "Total Dollar Sales": "$138,000", "Star Tech Units %": "21.74%", "Star Tech Dollar %": "21.74%"},
      {"Date": "2023-05-24", "Star Tech Units Sold": "115", "Star Tech Dollar Sales": "$23,000", "Other Units Sold": "480", "Other Dollar Sales": "$96,000", "Total Units Sold": "595", "Total Dollar Sales": "$119,000", "Star Tech Units %": "19.33%", "Star Tech Dollar %": "19.33%"},
      {"Date": "2023-05-25", "Star Tech Units Sold": "160", "Star Tech Dollar Sales": "$32,000", "Other Units Sold": "550", "Other Dollar Sales": "$110,000", "Total Units Sold": "710", "Total Dollar Sales": "$142,000", "Star Tech Units %": "22.54%", "Star Tech Dollar %": "22.54%"},
      {"Date": "2023-05-26", "Star Tech Units Sold": "145", "Star Tech Dollar Sales": "$29,000", "Other Units Sold": "530", "Other Dollar Sales": "$106,000", "Total Units Sold": "675", "Total Dollar Sales": "$135,000", "Star Tech Units %": "21.48%", "Star Tech Dollar %": "21.48%"},
      {"Date": "2023-05-27", "Star Tech Units Sold": "170", "Star Tech Dollar Sales": "$34,000", "Other Units Sold": "570", "Other Dollar Sales": "$114,000", "Total Units Sold": "740", "Total Dollar Sales": "$148,000", "Star Tech Units %": "22.97%", "Star Tech Dollar %": "22.97%"},
      {"Date": "2023-05-28", "Star Tech Units Sold": "130", "Star Tech Dollar Sales": "$26,000", "Other Units Sold": "490", "Other Dollar Sales": "$98,000", "Total Units Sold": "620", "Total Dollar Sales": "$124,000", "Star Tech Units %": "20.97%", "Star Tech Dollar %": "20.97%"},
      {"Date": "2023-05-29", "Star Tech Units Sold": "180", "Star Tech Dollar Sales": "$36,000", "Other Units Sold": "600", "Other Dollar Sales": "$120,000", "Total Units Sold": "780", "Total Dollar Sales": "$156,000", "Star Tech Units %": "23.08%", "Star Tech Dollar %": "23.08%"},
      {"Date": "2023-05-30", "Star Tech Units Sold": "165", "Star Tech Dollar Sales": "$33,000", "Other Units Sold": "550", "Other Dollar Sales": "$110,000", "Total Units Sold": "715", "Total Dollar Sales": "$143,000", "Star Tech Units %": "23.08%", "Star Tech Dollar %": "23.08%"},
      {"Date": "2023-05-31", "Star Tech Units Sold": "140", "Star Tech Dollar Sales": "$28,000", "Other Units Sold": "520", "Other Dollar Sales": "$104,000", "Total Units Sold": "660", "Total Dollar Sales": "$132,000", "Star Tech Units %": "21.21%", "Star Tech Dollar %": "21.21%"},
      {"Date": "2023-06-01", "Star Tech Units Sold": "155", "Star Tech Dollar Sales": "$31,000", "Other Units Sold": "560", "Other Dollar Sales": "$112,000", "Total Units Sold": "715", "Total Dollar Sales": "$143,000", "Star Tech Units %": "21.68%", "Star Tech Dollar %": "21.68%"},
      {"Date": "2023-06-02", "Star Tech Units Sold": "175", "Star Tech Dollar Sales": "$35,000", "Other Units Sold": "590", "Other Dollar Sales": "$118,000", "Total Units Sold": "765", "Total Dollar Sales": "$153,000", "Star Tech Units %": "22.88%", "Star Tech Dollar %": "22.88%"},
      {"Date": "2023-06-03", "Star Tech Units Sold": "160", "Star Tech Dollar Sales": "$32,000", "Other Units Sold": "570", "Other Dollar Sales": "$114,000", "Total Units Sold": "730", "Total Dollar Sales": "$146,000", "Star Tech Units %": "21.92%", "Star Tech Dollar %": "21.92%"},
      {"Date": "2023-06-04", "Star Tech Units Sold": "145", "Star Tech Dollar Sales": "$29,000", "Other Units Sold": "540", "Other Dollar Sales": "$108,000", "Total Units Sold": "685", "Total Dollar Sales": "$137,000", "Star Tech Units %": "21.17%", "Star Tech Dollar %": "21.17%"},
      {"Date": "2023-06-05", "Star Tech Units Sold": "130", "Star Tech Dollar Sales": "$26,000", "Other Units Sold": "500", "Other Dollar Sales": "$100,000", "Total Units Sold": "630", "Total Dollar Sales": "$126,000", "Star Tech Units %": "20.63%", "Star Tech Dollar %": "20.63%"}
    ],
    "status": "complete",
    "results":[{
        "bytes": 1.7,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 29,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example2.csv"
      }]
  },
  "canyoupullacustomerlistfromsegmentbasedonmembershipin%brand%loyaltyprogramandwhethertheymadeapurchaseoraredemptioninthepastweek?dothesamepullfromlytics,thenmergethetwolistsanddedupe.iwanttoseetotaltransactionsandlastinteractiontimestampsbycustomer,customeridandemailaddress.": {
    "message": "Can you pull a customer list from Segment based on membership in %Brand% loyalty program and whether they made a purchase or a redemption in the past week? Do the same pull from Lytics, then merge the two lists and dedupe. I want to see total transactions and last interaction timestamps by customer, customer ID and email address.",
    "description": "This query first selects distinct customer IDs, email addresses, and [last_interaction] timestamps from both the Segment and Lytics tables, and sums up the total transactions from both tables. It then filters the results based on membership in Wawa's loyalty program and whether a purchase or redemption was made in the past week. Finally, it merges the two lists.",
    "id": "query#1234567895",
    "sql": "SELECT DISTINCT s.customer_id, s.email, s.last_interaction_timestamp, COALESCE(s.total_transactions, 0) + COALESCE(l.total_transactions, 0) AS total_transactions FROM (SELECT customer_id, email, MAX(last_interaction_timestamp) AS last_interaction_timestamp, COUNT(*) AS total_transactions FROM Segment WHERE loyalty_status = 'Wawa Rewards Member' AND (purchase_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 WEEK) OR redemption_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 WEEK)) GROUP BY customer_id, email) s LEFT JOIN (SELECT customer_id, email, MAX(last_interaction_timestamp) AS last_interaction_timestamp, COUNT(*) AS total_transactions FROM Lytics WHERE loyalty_program = 'Wawa' AND (purchase_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 WEEK) OR redemption_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 WEEK)) GROUP BY customer_id, email) l ON s.customer_id = l.customer_id AND s.email = l.email;",
    "target": "model.dbt_tutorial.loyalty",
    "variables": [
        {
          "id": "last_interaction",
          "model": "",
          "name": "Last_Interaction",
          "type": "select_multi",
          "value": "last interaction",
          "txt": "last interaction",
          "detail": "Examines ‘TXN_EVENT’ table and ‘SIGN_UP’ events and chooses the most recent timestamp for a given CID.",
          "description": "Choose a different variable(s) for desired “last interaction” events from the following choices:",
          "selectData": ["HELP_TICKET_CREATE", "SIGN_UP", "TXN_EVENT", "SITE_LOGIN"]
        }
    ],
    "graph": [],
    "observations":"Overall, there are 553 customers that fit all the requirements, we’ve identified 17 possible duplicates and eliminated them from the list. These users on average have a basket size of $13.24 and are at least 0.7 years in tenure as part of Wawa’s Rewards program. ",
    "notes": [
      "Note on Rows: A colleague has remarked the data from at least one of your sources as having an issue for two weeks in the desired coverage period. This note indicates that the data may not be accurate, but is still reliable within a margin of error. This was caused by a corrupt upload that had to be manually overridden by a team member.",
      "Consider Pivot Table: We’ve formatted the data so that it can be used in a Sheets app like Excel or Google Sheets optimized to allow for pivot tables against objectives like product ID and store ID. Would you like to see the data weekly instead of cumulatively over the last 52 weeks?",
      "Quick Comp vs Last Week: Week over week performance of customers fitting these criteria indicate that this latest batch of customers are more tenured and more likely to have larger basket sizes than the same list last week. 15% of the customers on this list are the same as customers from last week’s pull of the same criteria. "
    ],
    "columns": ["Customer ID", "Email", "Last Interact", "Timestamp", "Total Txns"],
    "rows": [
        {"Customer ID": "#LWIL02001", "Email": "user1@example.com", "Last Interact": "01684578601", "Timestamp": "3/11/2024", "Total Txns": 230000},
        {"Customer ID": "#LWIL02002", "Email": "user2@example.com", "Last Interact": "01684578602", "Timestamp": "3/11/2024", "Total Txns": 190000},
        {"Customer ID": "#LWIL02003", "Email": "user3@example.com", "Last Interact": "01684578603", "Timestamp": "3/10/2024", "Total Txns": 210000},
        {"Customer ID": "#LWIL02004", "Email": "user4@example.com", "Last Interact": "01684578604", "Timestamp": "3/10/2024", "Total Txns": 220000},
        {"Customer ID": "#LWIL02005", "Email": "user5@example.com", "Last Interact": "01684578605", "Timestamp": "3/10/2024", "Total Txns": 240000},
        {"Customer ID": "#LWIL02006", "Email": "user6@example.com", "Last Interact": "01684578606", "Timestamp": "3/10/2024", "Total Txns": 250000},
        {"Customer ID": "#LWIL02007", "Email": "user7@example.com", "Last Interact": "01684578607", "Timestamp": "3/10/2024", "Total Txns": 260000},
        {"Customer ID": "#LWIL02008", "Email": "user8@example.com", "Last Interact": "01684578608", "Timestamp": "3/10/2024", "Total Txns": 270000},
        {"Customer ID": "#LWIL02009", "Email": "user9@example.com", "Last Interact": "01684578609", "Timestamp": "3/10/2024", "Total Txns": 280000},
        {"Customer ID": "#LWIL02010", "Email": "user10@example.com", "Last Interact": "01684578610", "Timestamp": "3/10/2024", "Total Txns": 290000},
        {"Customer ID": "#LWIL02011", "Email": "user11@example.com", "Last Interact": "01684578611", "Timestamp": "3/10/2024", "Total Txns": 300000},
        {"Customer ID": "#LWIL02012", "Email": "user12@example.com", "Last Interact": "01684578612", "Timestamp": "3/10/2024", "Total Txns": 310000},
        {"Customer ID": "#LWIL02013", "Email": "user13@example.com", "Last Interact": "01684578613", "Timestamp": "3/10/2024", "Total Txns": 320000},
        {"Customer ID": "#LWIL02014", "Email": "user14@example.com", "Last Interact": "01684578614", "Timestamp": "3/10/2024", "Total Txns": 330000},
        {"Customer ID": "#LWIL02015", "Email": "user15@example.com", "Last Interact": "01684578615", "Timestamp": "3/10/2024", "Total Txns": 340000},
        {"Customer ID": "#LWIL02016", "Email": "user16@example.com", "Last Interact": "01684578616", "Timestamp": "3/10/2024", "Total Txns": 350000},
        {"Customer ID": "#LWIL02017", "Email": "user17@example.com", "Last Interact": "01684578617", "Timestamp": "3/10/2024", "Total Txns": 360000},
        {"Customer ID": "#LWIL02018", "Email": "user18@example.com", "Last Interact": "01684578618", "Timestamp": "3/10/2024", "Total Txns": 370000},
        {"Customer ID": "#LWIL02019", "Email": "user19@example.com", "Last Interact": "01684578619", "Timestamp": "3/10/2024", "Total Txns": 380000},
        {"Customer ID": "#LWIL02020", "Email": "user20@example.com", "Last Interact": "01684578620", "Timestamp": "3/10/2024", "Total Txns": 390000},
        {"Customer ID": "#LWIL02021", "Email": "user21@example.com", "Last Interact": "01684578621", "Timestamp": "3/10/2024", "Total Txns": 400000},
        {"Customer ID": "#LWIL02022", "Email": "user22@example.com", "Last Interact": "01684578622", "Timestamp": "3/10/2024", "Total Txns": 410000},
        {"Customer ID": "#LWIL02023", "Email": "user23@example.com", "Last Interact": "01684578623", "Timestamp": "3/10/2024", "Total Txns": 420000},
        {"Customer ID": "#LWIL02024", "Email": "user24@example.com", "Last Interact": "01684578624", "Timestamp": "3/10/2024", "Total Txns": 430000},
        {"Customer ID": "#LWIL02025", "Email": "user25@example.com", "Last Interact": "01684578625", "Timestamp": "3/10/2024", "Total Txns": 440000},
        {"Customer ID": "#LWIL02026", "Email": "user26@example.com", "Last Interact": "01684578626", "Timestamp": "3/10/2024", "Total Txns": 450000},
        {"Customer ID": "#LWIL02027", "Email": "user27@example.com", "Last Interact": "01684578627", "Timestamp": "3/10/2024", "Total Txns": 460000},
        {"Customer ID": "#LWIL02028", "Email": "user28@example.com", "Last Interact": "01684578628", "Timestamp": "3/10/2024", "Total Txns": 470000},
        {"Customer ID": "#LWIL02029", "Email": "user29@example.com", "Last Interact": "01684578629", "Timestamp": "3/10/2024", "Total Txns": 480000},
        {"Customer ID": "#LWIL02030", "Email": "user30@example.com", "Last Interact": "01684578630", "Timestamp": "3/10/2024", "Total Txns": 490000},
        {"Customer ID": "#LWIL02031", "Email": "user31@example.com", "Last Interact": "01684578631", "Timestamp": "3/10/2024", "Total Txns": 500000},
        {"Customer ID": "#LWIL02032", "Email": "user32@example.com", "Last Interact": "01684578632", "Timestamp": "3/10/2024", "Total Txns": 510000},
        {"Customer ID": "#LWIL02033", "Email": "user33@example.com", "Last Interact": "01684578633", "Timestamp": "3/10/2024", "Total Txns": 520000},
        {"Customer ID": "#LWIL02034", "Email": "user34@example.com", "Last Interact": "01684578634", "Timestamp": "3/10/2024", "Total Txns": 530000},
        {"Customer ID": "#LWIL02035", "Email": "user35@example.com", "Last Interact": "01684578635", "Timestamp": "3/10/2024", "Total Txns": 540000},
        {"Customer ID": "#LWIL02036", "Email": "user36@example.com", "Last Interact": "01684578636", "Timestamp": "3/10/2024", "Total Txns": 550000},
        {"Customer ID": "#LWIL02037", "Email": "user37@example.com", "Last Interact": "01684578637", "Timestamp": "3/10/2024", "Total Txns": 560000},
        {"Customer ID": "#LWIL02038", "Email": "user38@example.com", "Last Interact": "01684578638", "Timestamp": "3/10/2024", "Total Txns": 570000},
        {"Customer ID": "#LWIL02039", "Email": "user39@example.com", "Last Interact": "01684578639", "Timestamp": "3/10/2024", "Total Txns": 580000},
        {"Customer ID": "#LWIL02040", "Email": "user40@example.com", "Last Interact": "01684578640", "Timestamp": "3/10/2024", "Total Txns": 590000},
        {"Customer ID": "#LWIL02041", "Email": "user41@example.com", "Last Interact": "01684578641", "Timestamp": "3/10/2024", "Total Txns": 600000},
        {"Customer ID": "#LWIL02042", "Email": "user42@example.com", "Last Interact": "01684578642", "Timestamp": "3/10/2024", "Total Txns": 610000},
        {"Customer ID": "#LWIL02043", "Email": "user43@example.com", "Last Interact": "01684578643", "Timestamp": "3/10/2024", "Total Txns": 620000},
        {"Customer ID": "#LWIL02044", "Email": "user44@example.com", "Last Interact": "01684578644", "Timestamp": "3/10/2024", "Total Txns": 630000}
    ],
    "status": "complete",
    "results": [
      {
        "bytes": 2.6,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 44,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example5.csv"
      }
    ]
  },
  "getlistof100customersorderdate":  {
    "message": "Get list of 100 customers order date",
    "description": "A list of customers with their first order date, last order date, and order count, along with any additional information from the merged shop data, for customers who have made [orders_number] or more orders.",
    "id": "query#1234567894",
    "sql": "with customers as (select id as customer_id, first_name, last_name from `helical-math-378821`.`shop`.`customers`), orders as (select id as order_id, user_id as customer_id, order_date, status from `helical-math-378821`.`shop`.`orders`), customer_orders as (select customer_id, min(order_date) as first_order_date, max(order_date) as last_order_date, count(order_id) as order_count from orders group by 1), final as (select customers.customer_id, customers.first_name, customers.last_name, customer_orders.first_order_date, customer_orders.last_order_date, coalesce(customer_orders.order_count, 0) as order_count from customers left join customer_orders using (customer_id)) select * from final where order_count >= 2",
    "target": "model.dbt_tutorial.loyalty",
    "variables": [
        {
          "id": "orders_number",
          "model": "",
          "name": "Orders_Number",
          "type": "numeric",
          "value": 2,
          "txt": 2,
          "description": "Chose Number of Orders."
        } 
    ],
    "graph": [],
    "observations":"Over the past last order date, and order count, along with any additional information from the merged shop data, for customers who have made 2 or more orders.",
    "notes": [],
    "columns": ["Date", "Star Tech Units Sold", "Star Tech Dollar Sales", "Other Units Sold", "Other Dollar Sales", "Total Units Sold", "Total Dollar Sales", "Star Tech Units %", "Star Tech Dollar %"],
    "rows": [
      {"Date": "2023-05-15", "Star Tech Units Sold": "120", "Star Tech Dollar Sales": "$24,000", "Other Units Sold": "450", "Other Dollar Sales": "$90,000", "Total Units Sold": "570", "Total Dollar Sales": "$114,000", "Star Tech Units %": "21.05%", "Star Tech Dollar %": "21.05%"},
      {"Date": "2023-05-16", "Star Tech Units Sold": "110", "Star Tech Dollar Sales": "$22,000", "Other Units Sold": "480", "Other Dollar Sales": "$96,000", "Total Units Sold": "590", "Total Dollar Sales": "$118,000", "Star Tech Units %": "18.64%", "Star Tech Dollar %": "18.64%"},
      {"Date": "2023-05-17", "Star Tech Units Sold": "130", "Star Tech Dollar Sales": "$26,000", "Other Units Sold": "500", "Other Dollar Sales": "$100,000", "Total Units Sold": "630", "Total Dollar Sales": "$126,000", "Star Tech Units %": "20.63%", "Star Tech Dollar %": "20.63%"},
      {"Date": "2023-05-18", "Star Tech Units Sold": "115", "Star Tech Dollar Sales": "$23,000", "Other Units Sold": "460", "Other Dollar Sales": "$92,000", "Total Units Sold": "575", "Total Dollar Sales": "$115,000", "Star Tech Units %": "20.00%", "Star Tech Dollar %": "20.00%"},
      {"Date": "2023-05-19", "Star Tech Units Sold": "140", "Star Tech Dollar Sales": "$28,000", "Other Units Sold": "520", "Other Dollar Sales": "$104,000", "Total Units Sold": "660", "Total Dollar Sales": "$132,000", "Star Tech Units %": "21.21%", "Star Tech Dollar %": "21.21%"},
      {"Date": "2023-05-20", "Star Tech Units Sold": "125", "Star Tech Dollar Sales": "$25,000", "Other Units Sold": "490", "Other Dollar Sales": "$98,000", "Total Units Sold": "615", "Total Dollar Sales": "$123,000", "Star Tech Units %": "20.33%", "Star Tech Dollar %": "20.33%"},
      {"Date": "2023-05-21", "Star Tech Units Sold": "135", "Star Tech Dollar Sales": "$27,000", "Other Units Sold": "510", "Other Dollar Sales": "$102,000", "Total Units Sold": "645", "Total Dollar Sales": "$129,000", "Star Tech Units %": "20.93%", "Star Tech Dollar %": "20.93%"},
      {"Date": "2023-05-22", "Star Tech Units Sold": "105", "Star Tech Dollar Sales": "$21,000", "Other Units Sold": "470", "Other Dollar Sales": "$94,000", "Total Units Sold": "575", "Total Dollar Sales": "$115,000", "Star Tech Units %": "18.26%", "Star Tech Dollar %": "18.26%"},
      {"Date": "2023-05-23", "Star Tech Units Sold": "150", "Star Tech Dollar Sales": "$30,000", "Other Units Sold": "540", "Other Dollar Sales": "$108,000", "Total Units Sold": "690", "Total Dollar Sales": "$138,000", "Star Tech Units %": "21.74%", "Star Tech Dollar %": "21.74%"},
      {"Date": "2023-05-24", "Star Tech Units Sold": "115", "Star Tech Dollar Sales": "$23,000", "Other Units Sold": "480", "Other Dollar Sales": "$96,000", "Total Units Sold": "595", "Total Dollar Sales": "$119,000", "Star Tech Units %": "19.33%", "Star Tech Dollar %": "19.33%"},
      {"Date": "2023-05-25", "Star Tech Units Sold": "160", "Star Tech Dollar Sales": "$32,000", "Other Units Sold": "550", "Other Dollar Sales": "$110,000", "Total Units Sold": "710", "Total Dollar Sales": "$142,000", "Star Tech Units %": "22.54%", "Star Tech Dollar %": "22.54%"},
      {"Date": "2023-05-26", "Star Tech Units Sold": "145", "Star Tech Dollar Sales": "$29,000", "Other Units Sold": "530", "Other Dollar Sales": "$106,000", "Total Units Sold": "675", "Total Dollar Sales": "$135,000", "Star Tech Units %": "21.48%", "Star Tech Dollar %": "21.48%"},
      {"Date": "2023-05-27", "Star Tech Units Sold": "170", "Star Tech Dollar Sales": "$34,000", "Other Units Sold": "570", "Other Dollar Sales": "$114,000", "Total Units Sold": "740", "Total Dollar Sales": "$148,000", "Star Tech Units %": "22.97%", "Star Tech Dollar %": "22.97%"},
      {"Date": "2023-05-28", "Star Tech Units Sold": "130", "Star Tech Dollar Sales": "$26,000", "Other Units Sold": "490", "Other Dollar Sales": "$98,000", "Total Units Sold": "620", "Total Dollar Sales": "$124,000", "Star Tech Units %": "20.97%", "Star Tech Dollar %": "20.97%"},
      {"Date": "2023-05-29", "Star Tech Units Sold": "180", "Star Tech Dollar Sales": "$36,000", "Other Units Sold": "600", "Other Dollar Sales": "$120,000", "Total Units Sold": "780", "Total Dollar Sales": "$156,000", "Star Tech Units %": "23.08%", "Star Tech Dollar %": "23.08%"},
      {"Date": "2023-05-30", "Star Tech Units Sold": "165", "Star Tech Dollar Sales": "$33,000", "Other Units Sold": "550", "Other Dollar Sales": "$110,000", "Total Units Sold": "715", "Total Dollar Sales": "$143,000", "Star Tech Units %": "23.08%", "Star Tech Dollar %": "23.08%"},
      {"Date": "2023-05-31", "Star Tech Units Sold": "140", "Star Tech Dollar Sales": "$28,000", "Other Units Sold": "520", "Other Dollar Sales": "$104,000", "Total Units Sold": "660", "Total Dollar Sales": "$132,000", "Star Tech Units %": "21.21%", "Star Tech Dollar %": "21.21%"},
      {"Date": "2023-06-01", "Star Tech Units Sold": "155", "Star Tech Dollar Sales": "$31,000", "Other Units Sold": "560", "Other Dollar Sales": "$112,000", "Total Units Sold": "715", "Total Dollar Sales": "$143,000", "Star Tech Units %": "21.68%", "Star Tech Dollar %": "21.68%"},
      {"Date": "2023-06-02", "Star Tech Units Sold": "175", "Star Tech Dollar Sales": "$35,000", "Other Units Sold": "590", "Other Dollar Sales": "$118,000", "Total Units Sold": "765", "Total Dollar Sales": "$153,000", "Star Tech Units %": "22.88%", "Star Tech Dollar %": "22.88%"},
      {"Date": "2023-06-03", "Star Tech Units Sold": "160", "Star Tech Dollar Sales": "$32,000", "Other Units Sold": "570", "Other Dollar Sales": "$114,000", "Total Units Sold": "730", "Total Dollar Sales": "$146,000", "Star Tech Units %": "21.92%", "Star Tech Dollar %": "21.92%"},
      {"Date": "2023-06-04", "Star Tech Units Sold": "145", "Star Tech Dollar Sales": "$29,000", "Other Units Sold": "540", "Other Dollar Sales": "$108,000", "Total Units Sold": "685", "Total Dollar Sales": "$137,000", "Star Tech Units %": "21.17%", "Star Tech Dollar %": "21.17%"},
      {"Date": "2023-06-05", "Star Tech Units Sold": "130", "Star Tech Dollar Sales": "$26,000", "Other Units Sold": "500", "Other Dollar Sales": "$100,000", "Total Units Sold": "630", "Total Dollar Sales": "$126,000", "Star Tech Units %": "20.63%", "Star Tech Dollar %": "20.63%"}
    ],
    "status": "complete",
    "results": [
      {
        "bytes": 1.7,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 29,
        "schema": "shop",
        "table": "loyalty",
        "url": "/example2.csv"
      }
    ]
  }
}
