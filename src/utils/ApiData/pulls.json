[
  {
    "query": "I’d like a table that shows me the average order value of our products compared to the average order value of the rest of category each quarter for the last 4 quarters.",
    "description": "This query first calculates the total order value and number of orders for each product from the Sales DB and for the category (minus our products) from the Category DB for each quarter, using sales database. It then calculates the average order value for our products and the rest of category for each quarter, and returns the results for the most recent 4 quarters.",
    "id": "query#1234567891",
    "sql": "WITH product_sales AS ( SELECT EXTRACT(QUARTER FROM sale_date) AS sale_quarter, EXTRACT(YEAR FROM sale_date) AS sale_year, product_id, SUM(order_value) AS total_order_value, COUNT(DISTINCT order_id) AS num_orders FROM sales_data WHERE product_id IN (SELECT product_id FROM product_db WHERE brand = 'our_brand') GROUP BY EXTRACT(QUARTER FROM sale_date), EXTRACT(YEAR FROM sale_date), product_id ), category_sales AS ( SELECT EXTRACT(QUARTER FROM sale_date) AS sale_quarter, EXTRACT(YEAR FROM sale_date) AS sale_year, category_id, SUM(order_value) AS total_order_value, COUNT(DISTINCT order_id) AS num_orders FROM sales_data WHERE product_id NOT IN (SELECT product_id FROM product_db WHERE brand = 'our_brand') AND category_id IN (SELECT category_id FROM product_db WHERE brand = 'our_brand') GROUP BY EXTRACT(QUARTER FROM sale_date), EXTRACT(YEAR FROM sale_date), category_id ) SELECT p.sale_quarter, p.sale_year, AVG(p.total_order_value / p.num_orders) AS avg_order_value, AVG(c.total_order_value / c.num_orders) AS avg_category_order_value FROM product_sales p JOIN category_sales c ON p.sale_quarter = c.sale_quarter AND p.sale_year = c.sale_year WHERE p.sale_quarter IN ( SELECT EXTRACT(QUARTER FROM sale_date) FROM sales_data WHERE EXTRACT(YEAR FROM sale_date) = EXTRACT(YEAR FROM CURRENT_DATE) ORDER BY sale_date DESC LIMIT 4 ) GROUP BY p.sale_quarter, p.sale_year ORDER BY p.sale_quarter DESC;",
    "target": "",
    "graph": [
      {
        "depends": [],
        "description": "table of sales data",
        "id": "model.dbt_tutorial.sales",
        "name": "sales"
      },
      {
        "depends": [],
        "description": "table of orders data",
        "id": "model.dbt_tutorial.orders",
        "name": "orders"
      },
      {
        "depends": [
          "model.dbt_tutorial.sales",
          "model.dbt_tutorial.orders"
        ],
        "description": "the results for the most recent N quarters",
        "id": "model.dbt_tutorial.quarter",
        "name": "quarter"
      },
      {
        "depends": [
          "model.dbt_tutorial.quarter"
        ],
        "description": "table of products data",
        "id": "model.dbt_tutorial.products",
        "name": "products"
      }
    ],
    "variables": [
      {
        "id": "quarter_order_thresh",
        "model": "model.dbt_tutorial.quarter",
        "name": "quarter_order_thresh",
        "type": "numeric",
        "value": 4
      }
    ],
    "observations": "In the most recent four quarters, our products generated a total revenue of $10 million across all regions, with an average order value of $300. Comparatively, the rest of the category contributed $20 million in revenue with an average order value of $200.",
    "notes": [
      "Quarterly Revenue Trends: Analyzing quarterly revenue trends can help identify seasonal patterns or fluctuations in consumer demand.",
      "Profit Margin Analysis: Calculate the average profit margin for our products and compare it with the category average to assess profitability.",
      "Geographical Performance: Assess sales performance by region, calculating the percentage increase in revenue by region compared to the previous quarter. We’re seeing up to 20% increases in certain regions which is greater than what we’d expect this year.",
      "Promotional Impact: Evaluate the ROI for recent promotional activities by calculating the percentage increase in revenue attributed to promotions. The average promotional lift for this time period is 15%, which is 1.5% less than previous year.",
      "Customer Segmentation: Segment customers based on purchasing behavior to target marketing efforts effectively using Puller AI’s advanced analytics module."
    ],
    "columns": [
      "Product",
      "Current Stock",
      "Reorder Level",
      "Reorder Quantity",
      "Last in Stock Date"
    ],
    "rows": [
      {
        "Product": "Product A",
        "Current Stock": "250",
        "Reorder Level": "50",
        "Reorder Quantity": "200",
        "Last in Stock Date": "2023-05-15"
      },
      {
        "Product": "Product B",
        "Current Stock": "134",
        "Reorder Level": "75",
        "Reorder Quantity": "100",
        "Last in Stock Date": "2023-05-14"
      },
      {
        "Product": "Product C",
        "Current Stock": "78",
        "Reorder Level": "30",
        "Reorder Quantity": "50",
        "Last in Stock Date": "2023-05-13"
      },
      {
        "Product": "Product D",
        "Current Stock": "567",
        "Reorder Level": "100",
        "Reorder Quantity": "300",
        "Last in Stock Date": "2023-05-12"
      },
      {
        "Product": "Product E",
        "Current Stock": "98",
        "Reorder Level": "20",
        "Reorder Quantity": "60",
        "Last in Stock Date": "2023-05-11"
      },
      {
        "Product": "Product F",
        "Current Stock": "220",
        "Reorder Level": "45",
        "Reorder Quantity": "150",
        "Last in Stock Date": "2023-05-10"
      },
      {
        "Product": "Product G",
        "Current Stock": "400",
        "Reorder Level": "80",
        "Reorder Quantity": "250",
        "Last in Stock Date": "2023-05-09"
      },
      {
        "Product": "Product H",
        "Current Stock": "123",
        "Reorder Level": "55",
        "Reorder Quantity": "90",
        "Last in Stock Date": "2023-05-08"
      },
      {
        "Product": "Product I",
        "Current Stock": "87",
        "Reorder Level": "35",
        "Reorder Quantity": "75",
        "Last in Stock Date": "2023-05-07"
      },
      {
        "Product": "Product J",
        "Current Stock": "210",
        "Reorder Level": "60",
        "Reorder Quantity": "170",
        "Last in Stock Date": "2023-05-06"
      },
      {
        "Product": "Product K",
        "Current Stock": "345",
        "Reorder Level": "120",
        "Reorder Quantity": "220",
        "Last in Stock Date": "2023-05-05"
      },
      {
        "Product": "Product L",
        "Current Stock": "56",
        "Reorder Level": "25",
        "Reorder Quantity": "80",
        "Last in Stock Date": "2023-05-04"
      },
      {
        "Product": "Product M",
        "Current Stock": "198",
        "Reorder Level": "70",
        "Reorder Quantity": "140",
        "Last in Stock Date": "2023-05-03"
      },
      {
        "Product": "Product N",
        "Current Stock": "270",
        "Reorder Level": "90",
        "Reorder Quantity": "200",
        "Last in Stock Date": "2023-05-02"
      },
      {
        "Product": "Product O",
        "Current Stock": "312",
        "Reorder Level": "110",
        "Reorder Quantity": "250",
        "Last in Stock Date": "2023-05-01"
      },
      {
        "Product": "Product P",
        "Current Stock": "147",
        "Reorder Level": "60",
        "Reorder Quantity": "100",
        "Last in Stock Date": "2023-04-30"
      },
      {
        "Product": "Product Q",
        "Current Stock": "89",
        "Reorder Level": "40",
        "Reorder Quantity": "70",
        "Last in Stock Date": "2023-04-29"
      },
      {
        "Product": "Product R",
        "Current Stock": "354",
        "Reorder Level": "130",
        "Reorder Quantity": "210",
        "Last in Stock Date": "2023-04-28"
      },
      {
        "Product": "Product S",
        "Current Stock": "120",
        "Reorder Level": "50",
        "Reorder Quantity": "90",
        "Last in Stock Date": "2023-04-27"
      },
      {
        "Product": "Product T",
        "Current Stock": "403",
        "Reorder Level": "95",
        "Reorder Quantity": "220",
        "Last in Stock Date": "2023-04-26"
      },
      {
        "Product": "Product U",
        "Current Stock": "258",
        "Reorder Level": "75",
        "Reorder Quantity": "180",
        "Last in Stock Date": "2023-04-25"
      },
      {
        "Product": "Product V",
        "Current Stock": "68",
        "Reorder Level": "30",
        "Reorder Quantity": "50",
        "Last in Stock Date": "2023-04-24"
      },
      {
        "Product": "Product W",
        "Current Stock": "320",
        "Reorder Level": "100",
        "Reorder Quantity": "200",
        "Last in Stock Date": "2023-04-23"
      },
      {
        "Product": "Product X",
        "Current Stock": "153",
        "Reorder Level": "65",
        "Reorder Quantity": "110",
        "Last in Stock Date": "2023-04-22"
      },
      {
        "Product": "Product Y",
        "Current Stock": "290",
        "Reorder Level": "85",
        "Reorder Quantity": "190",
        "Last in Stock Date": "2023-04-21"
      },
      {
        "Product": "Product Z",
        "Current Stock": "410",
        "Reorder Level": "120",
        "Reorder Quantity": "230",
        "Last in Stock Date": "2023-04-20"
      },
      {
        "Product": "Product AA",
        "Current Stock": "75",
        "Reorder Level": "40",
        "Reorder Quantity": "70",
        "Last in Stock Date": "2023-04-19"
      },
      {
        "Product": "Product AB",
        "Current Stock": "205",
        "Reorder Level": "80",
        "Reorder Quantity": "160",
        "Last in Stock Date": "2023-04-18"
      },
      {
        "Product": "Product AC",
        "Current Stock": "333",
        "Reorder Level": "105",
        "Reorder Quantity": "240",
        "Last in Stock Date": "2023-04-17"
      },
      {
        "Product": "Product AD",
        "Current Stock": "162",
        "Reorder Level": "60",
        "Reorder Quantity": "120",
        "Last in Stock Date": "2023-04-16"
      },
      {
        "Product": "Product AE",
        "Current Stock": "56",
        "Reorder Level": "20",
        "Reorder Quantity": "50",
        "Last in Stock Date": "2023-04-15"
      },
      {
        "Product": "Product AF",
        "Current Stock": "298",
        "Reorder Level": "90",
        "Reorder Quantity": "180",
        "Last in Stock Date": "2023-04-14"
      },
      {
        "Product": "Product AG",
        "Current Stock": "142",
        "Reorder Level": "50",
        "Reorder Quantity": "110",
        "Last in Stock Date": "2023-04-13"
      },
      {
        "Product": "Product AH",
        "Current Stock": "415",
        "Reorder Level": "130",
        "Reorder Quantity": "230",
        "Last in Stock Date": "2023-04-12"
      },
      {
        "Product": "Product AI",
        "Current Stock": "105",
        "Reorder Level": "45",
        "Reorder Quantity": "90",
        "Last in Stock Date": "2023-04-11"
      },
      {
        "Product": "Product AJ",
        "Current Stock": "275",
        "Reorder Level": "80",
        "Reorder Quantity": "170",
        "Last in Stock Date": "2023-04-10"
      },
      {
        "Product": "Product AK",
        "Current Stock": "324",
        "Reorder Level": "100",
        "Reorder Quantity": "210",
        "Last in Stock Date": "2023-04-09"
      },
      {
        "Product": "Product AL",
        "Current Stock": "184",
        "Reorder Level": "70",
        "Reorder Quantity": "140",
        "Last in Stock Date": "2023-04-08"
      },
      {
        "Product": "Product AM",
        "Current Stock": "62",
        "Reorder Level": "25",
        "Reorder Quantity": "60",
        "Last in Stock Date": "2023-04-07"
      },
      {
        "Product": "Product AN",
        "Current Stock": "376",
        "Reorder Level": "120",
        "Reorder Quantity": "220",
        "Last in Stock Date": "2023-04-06"
      },
      {
        "Product": "Product AO",
        "Current Stock": "212",
        "Reorder Level": "85",
        "Reorder Quantity": "160",
        "Last in Stock Date": "2023-04-05"
      },
      {
        "Product": "Product AP",
        "Current Stock": "330",
        "Reorder Level": "110",
        "Reorder Quantity": "240",
        "Last in Stock Date": "2023-04-04"
      },
      {
        "Product": "Product AQ",
        "Current Stock": "193",
        "Reorder Level": "65",
        "Reorder Quantity": "130",
        "Last in Stock Date": "2023-04-03"
      },
      {
        "Product": "Product AR",
        "Current Stock": "86",
        "Reorder Level": "35",
        "Reorder Quantity": "75",
        "Last in Stock Date": "2023-04-02"
      },
      {
        "Product": "Product AS",
        "Current Stock": "401",
        "Reorder Level": "100",
        "Reorder Quantity": "220",
        "Last in Stock Date": "2023-04-01"
      },
      {
        "Product": "Product AT",
        "Current Stock": "147",
        "Reorder Level": "55",
        "Reorder Quantity": "100",
        "Last in Stock Date": "2023-03-31"
      },
      {
        "Product": "Product AU",
        "Current Stock": "270",
        "Reorder Level": "80",
        "Reorder Quantity": "180",
        "Last in Stock Date": "2023-03-30"
      },
      {
        "Product": "Product AV",
        "Current Stock": "318",
        "Reorder Level": "110",
        "Reorder Quantity": "210",
        "Last in Stock Date": "2023-03-29"
      },
      {
        "Product": "Product AW",
        "Current Stock": "169",
        "Reorder Level": "70",
        "Reorder Quantity": "140",
        "Last in Stock Date": "2023-03-28"
      },
      {
        "Product": "Product AX",
        "Current Stock": "55",
        "Reorder Level": "30",
        "Reorder Quantity": "60",
        "Last in Stock Date": "2023-03-27"
      },
      {
        "Product": "Product AY",
        "Current Stock": "384",
        "Reorder Level": "120",
        "Reorder Quantity": "230",
        "Last in Stock Date": "2023-03-26"
      },
      {
        "Product": "Product AZ",
        "Current Stock": "213",
        "Reorder Level": "85",
        "Reorder Quantity": "170",
        "Last in Stock Date": "2023-03-25"
      },
      {
        "Product": "Product BA",
        "Current Stock": "326",
        "Reorder Level": "110",
        "Reorder Quantity": "220",
        "Last in Stock Date": "2023-03-24"
      },
      {
        "Product": "Product BB",
        "Current Stock": "174",
        "Reorder Level": "65",
        "Reorder Quantity": "130",
        "Last in Stock Date": "2023-03-23"
      },
      {
        "Product": "Product BC",
        "Current Stock": "58",
        "Reorder Level": "25",
        "Reorder Quantity": "50",
        "Last in Stock Date": "2023-03-22"
      },
      {
        "Product": "Product BD",
        "Current Stock": "390",
        "Reorder Level": "120",
        "Reorder Quantity": "240",
        "Last in Stock Date": "2023-03-21"
      },
      {
        "Product": "Product BE",
        "Current Stock": "231",
        "Reorder Level": "90",
        "Reorder Quantity": "180",
        "Last in Stock Date": "2023-03-20"
      },
      {
        "Product": "Product BF",
        "Current Stock": "308",
        "Reorder Level": "100",
        "Reorder Quantity": "210",
        "Last in Stock Date": "2023-03-19"
      },
      {
        "Product": "Product BG",
        "Current Stock": "194",
        "Reorder Level": "65",
        "Reorder Quantity": "130",
        "Last in Stock Date": "2023-03-18"
      },
      {
        "Product": "Product BH",
        "Current Stock": "67",
        "Reorder Level": "30",
        "Reorder Quantity": "60",
        "Last in Stock Date": "2023-03-17"
      },
      {
        "Product": "Product BI",
        "Current Stock": "378",
        "Reorder Level": "120",
        "Reorder Quantity": "220",
        "Last in Stock Date": "2023-03-16"
      },
      {
        "Product": "Product BJ",
        "Current Stock": "222",
        "Reorder Level": "85",
        "Reorder Quantity": "160",
        "Last in Stock Date": "2023-03-15"
      },
      {
        "Product": "Product BK",
        "Current Stock": "340",
        "Reorder Level": "110",
        "Reorder Quantity": "240",
        "Last in Stock Date": "2023-03-14"
      },
      {
        "Product": "Product BL",
        "Current Stock": "172",
        "Reorder Level": "65",
        "Reorder Quantity": "130",
        "Last in Stock Date": "2023-03-13"
      }
    ],
    "status": "complete",
    "results": [
      {
        "bytes": 221,
        "database": "Prototype",
        "duration": 3.0252435207366943,
        "message": "CREATE TABLE (29.0 rows, 3.7 KiB processed)",
        "rows": 29,
        "schema": "shop",
        "table": "loyalty",
        "url": "http://localhost:3000/examplePromptsCSV/example4.csv"
      }
    ]
  }
]